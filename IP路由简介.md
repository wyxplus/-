# ARP 协议

将 IP 地址映射成 MAC 地址（物理地址）的协议。



## ARP 工作原理

​	请求者发送**广播报文**。

​	接收者从该**请求报文**中提取出源主机的 IP 地址和物理地址的绑定，更新自己的 ARP 缓存。

​	接收者发回 **ARP 应答报文**给请求者。

​	请求者收到 **ARP 应答报文**后更新自己的 ARP 缓存。



## Q&A：

1. 二层设备转发 ARP 报文时，是否会学习到 ARP？

   不会。只能解析到 MAC 地址。无法获得 IP 地址。

2. 如果主机收到非请求自己的 ARP 请求报文，如何处理？

   保存发送方的 MAC 地址到 ARP 缓存中，但不响应。



## ARP 请求、应答报文格式

| DMAC | SMAC | 帧类型 | 硬件类型 | 协议类型 | 硬件地址长度 | 协议地址长度 |  op  | 发送端MAC | 发送端IP | 目的端MAC | 目的端IP |
| :--: | :--: | :----: | :------: | :------: | :----------: | :----------: | :--: | :-------: | :------: | :-------: | :------: |
|  6   |  6   |   2    |    2     |    2     |      1       |      1       |  2   |     6     |    4     |     6     |    4     |



# 路由选择



## 1.路由选择

选择一条路径发送IP数据报的过程



## 2.路由器

进行路由选择的计算机



## 3.IP互联网

1. IP互联网是由路由器将多个网络相互联接所组成的

2. IP互联网采用面向非连接的互联网解决方案

路由器**逐跳转发**：各个路由器独立地对待每个IP数据报

路由器负责为每个IP数据报选择它所认为的最佳路径





## 4. 特殊路由

### 1.默认路由

​	如果路由表没有明确指明一条到达目的网络的路由信息，就将数据报转发到默认路由指定的路由器。

​	主要目的：缩短路由表的长度、减少路由计算时间。

​	形式：D = 0.0.0.0 M = 0.0.0.0  N = 默认路由器地址。

### 2. 缺省网关

​     多是出现在PC的网络配置中，默认路由更多的是出现在网络设备上。

​     与默认路由本质一样。

​    PC上配置的缺省网关实际上就是在PC内核协议栈的网络层路由表中添加了一条默认路由

### 3. 特定主机路由

​	对单个主机（而不是网络）指定一条特别的路径

​	主要目的：增强安全性、进行网络连通性调试和判断路由表的正确性

​	形式：D = 主机IP M = 255.255.255.255 N = 到达该主机的下一跳路由器



# 无分类编码编址 CIDR

……计网知识点熟悉



# 静态路由和动态路由

## 静态路由

人工指定的路由。

## 动态路由

自学习路由。



## metric 路径度量值

metric的计算可以基于路径的一个特征，也可以基于路径的多个特征。

​	跳数（hop count）：IP数据报到达目的地必须经过的路由器个数。

​	带宽（bandwidth）：链路的数据能力。

​	延迟（delay）：将数据从源送到目的地所需的时间。

​	负载（load）：网络中（如路由器中或链路中）信息流的活动数量。

​	可靠性（reliability）：数据传输过程中的差错率。

​	开销（cost）：一个变化的数值，通常可以根据带宽、建设费用、维护费用、使用费用等因素由网络管理员指定。





# 交换机上的三层接口

## 1. 路由口

三层路由查找，不进行地址学习。

## 2. SVI 口

会进行地址学习，会进行二层转发，跨 VLAN 进行三层路由。

IP 地址是配置在 SVI 口上的，不是在 VLAN上的。